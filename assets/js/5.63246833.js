(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{288:function(t,s,a){t.exports=a.p+"assets/img/image-20200101231109566.bbd0399a.png"},289:function(t,s,a){t.exports=a.p+"assets/img/image-20200101231318273.d267dd0b.png"},290:function(t,s,a){t.exports=a.p+"assets/img/image-20200101231634784.2dd51c04.png"},307:function(t,s,a){"use strict";a.r(s);var n=a(13),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"travis-认识及实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#travis-认识及实践"}},[t._v("#")]),t._v(" Travis 认识及实践")]),t._v(" "),s("h3",{attrs:{id:"配置-access-token"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-access-token"}},[t._v("#")]),t._v(" 配置 access-token")]),t._v(" "),s("p",[t._v("因为Travis 在自动部署的时候，需要对github的仓库进去PUSH 操作，所以需要对Travis进去授权，Github提供了Access Token的方式，可以授权给Travis CI")]),t._v(" "),s("p",[t._v("新建token的位置："),s("code",[t._v("GitHub->Settings->Developer Settings->Personal access tokens")]),t._v("。")]),t._v(" "),s("p",[t._v("勾选"),s("code",[t._v("repo")]),t._v("下的所有项，以及"),s("code",[t._v("user")]),t._v("下的"),s("code",[t._v("user:email")]),t._v("后，生成一个token，复制token值。")]),t._v(" "),s("p",[s("img",{attrs:{src:a(288),alt:"image-20200101231109566"}})]),t._v(" "),s("p",[s("img",{attrs:{src:a(289),alt:"image-20200101231318273"}})]),t._v(" "),s("blockquote",[s("p",[t._v("注意：这个token只有新建成功时候可以看到，复制，所以妥善保管好。当然也可以新建一个")])]),t._v(" "),s("h3",{attrs:{id:"配置travis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置travis"}},[t._v("#")]),t._v(" 配置"),s("strong",[t._v("Travis")])]),t._v(" "),s("p",[t._v("在上一步得到token之后，就可以在Travis的仓库设置中设置环境变量，如下所示")]),t._v(" "),s("p",[s("img",{attrs:{src:a(290),alt:"image-20200101231634784"}})]),t._v(" "),s("h3",{attrs:{id:"travis-yml-文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#travis-yml-文件"}},[t._v("#")]),t._v(" "),s("code",[t._v(".travis.yml")]),t._v(" 文件")]),t._v(" "),s("p",[t._v("在根目录下新建"),s("code",[t._v(".travis.yml")]),t._v("文件")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("language")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" node_js\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node_js")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 12.13.1\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("directories")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node_modules "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#缓存依赖")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# S: Build Lifecycle")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("install")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" npm i\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" npm run build\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#after_script前5句是把部署分支的.git文件夹保护起来，用于保留历史部署的commit日志，否则部署分支永远只有一条commit记录。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#命令里面的变量都是在Travis CI里配置过的。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("after_script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" cd dist\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(' git config user.name "$'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("U_NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v('"\n  '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" git config At"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Cost Domain Pricing "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(' Domain Cost Club "$'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("U_EMAIL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v('"\n  '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" git add .\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" git commit "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v('m "'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("construction_worker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(' Build & Deploy by Travis CI"\n  '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" git push "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("force "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v('quiet "https'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Travis_Token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("@$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("GH_REF"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v('" master'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("D_BRANCH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# E: Build LifeCycle")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只有指定的分支提交时才会运行脚本")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("only")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" master\n\n")])])]),s("blockquote",[s("p",[s("strong",[t._v("注：")]),t._v(" 上述用到了环境变量，Travis_Token放在@符号之前，以https方式")])]),t._v(" "),s("h3",{attrs:{id:"reference"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[t._v("#")]),t._v(" 📚 Reference")]),t._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("持续集成服务 Travis CI 教程"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://docs.travis-ci.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1)])])]),t._v(" "),s("h3",{attrs:{id:""}},[s("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])])])}),[],!1,null,null,null);s.default=e.exports}}]);